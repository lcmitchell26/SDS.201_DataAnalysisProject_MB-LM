---
title: "SDS 201 Data Analysis Project"
author: "Musa Bah and Lily Mitchell"
format: 
    html:
      embed-resources: false
code-fold: false
execute: 
  echo: true 
knitr: 
  opts_chunk: 
    message: false
    warning: false 
editor: source 
bibliography: proj_refs.bib
---

```{r}
#| eval: true
#| echo: false
#| message: false

library(tidyverse)
library(googlesheets4)
library(ggplot2)
library(dplyr)
library(janitor)
library(moderndive)
library(knitr)
```

![BechdelTest](https://img10.hotstar.com/image/upload/f_auto/sources/r1/cms/prod/8995/1368995-i-b1fa2d292a86){width="900"}

# Hollywood vs. The Bechdel Test

Our research project brings Hollywood's long history of sexism face to face with the blatant truths that the power of statistics make perfectly clear. The Bechdel Test, designed to measure representation of women in film and other fictional media, is responsible for revealing the representational and monetary inequities of the industry. For a movie to pass the test it must feature two female characters who have conversations about a topic other than men. With data from @fivethirtyeight_bechdel movies we uncover the extent of the dilemma which we explore below. 

## Raw Data
```{r}
#| label: tbl-movies_raw
#| tbl-cap: "Raw Data Set Import "
#| eval: true
#| echo: false
#| message: false
movies_raw <- read_sheet("https://docs.google.com/spreadsheets/d/12xXTpjqwY35HV5WcAZtIGxnLc8xmBD0hQPVZKR5njcY/edit?gid=1554984819#gid=1554984819")
movies_raw_display <- slice(movies_raw, 1:3) 
kable(movies_raw_display) 
```
This @tbl-movies_raw displays the raw data we imported from @fivethirtyeight_bechdel to use for this project.

## Data for Analysis
```{r}
#| label: tbl-selected_moviedata
#| tbl-cap: "Wrangled Movies Data for Research Project "
#| eval: true
#| echo: false
#| message: false
movies <- movies_raw |>
  select(title, binary, budget)

movies <- slice(movies, 1:5)
kable(movies)
```

```{r}
#| label: tbl-movies_clean_budget
#| tbl-cap: "Movies Clean Includes the 2013 inflation adjusted Budget"
#| eval: true
#| echo: false
#| message: false
movies_clean <- movies_raw |>
  select(c("title", "binary", "budget_2013")) |>
  mutate(budget_2013 = as.numeric(budget_2013))
movies_clean_display <- slice(movies_clean, 1:5)
kable(movies_clean_display)
```
Here @tbl-selected_moviedata we see the variables that we include for our analysis. \

In @tbl-movies_clean_budget, the Budget variable has been wrangled and updated to reflect the 2013 inflation adjusted budget.\

## Summary of Data
```{r}
#| label: tbl-movies_summary
#| tbl-cap: "Summary of Movies Data "
#| eval: true
#| echo: false
#| message: false
plotting <- movies_clean |>
  group_by(binary) |>
  summarize(avg_budget = mean(budget_2013),
           Number = n(),
           Standard_Deviation = sd(budget_2013))
kable(plotting)
```

```{r}
#| label: fig-movies_histogram
#| fig-cap: "Average Budget Differences"
#| eval: true
#| echo: false
#| message: false
ggplot(plotting, aes(binary, avg_budget)) +
  geom_bar(stat = "identity")
```

```{r}
#| label: fig-movies_boxplot
#| fig-cap: "Boxplot showing the difference between average movie budgets more accuratly capturing outliers"
#| eval: true
#| echo: false
#| message: false
ggplot(movies_clean, aes(binary, budget_2013)) +
  geom_boxplot()
```

In @tbl-movies_summary we see the breakdown of average budgets that either pass or fail the Bechdel test, the standard deviation is given along with the measure of Central Tendancy and the Number column reflects the number of movies in each category contained in the data set.\

Next @fig-movies_histogram we see the that this bar plot visualizes the differnce between average budgets. This origional finding prompted our hypotesis test to explore this difference between budgets and passing or failing the bechdel test.\

In @fig-movies_boxplot we can see the breakdown of this differnce in average budget more precisely with a boxplot that captures outliers.\

## Hypothesis Testing
```{r}
#| label: fig-summary_stat
#| fig-cap: "Calculating the Summary Statistic for Hypothesis Test "
#| eval: true
#| echo: false
#| message: false
62911555 - 46274167
```

```{r}
#| label: tbl-regression_table
#| tbl-cap: "Regression Table"
#| eval: true
#| echo: false
#| message: false
bechdel_model <- lm(budget_2013 ~ binary, data = movies_clean)
get_regression_table(bechdel_model)
```

```{r}
#| label: fig-Categorical_vizualization
#| fig-cap: "Catagorical Visualization of difference between average movie budgets "
#| eval: true
#| echo: false
#| message: false
ggplot(bechdel_model, aes(x = binary, y = budget_2013)) +
  geom_jitter(width = 0.25) +
  geom_categorical_model() +
  labs(title = "Movie Budgets vs. Bechdel Test Binary",
       x = "Binary - PASS/FAIL",
       y = "Budget 2013") +
  theme_minimal()
```

The @tbl-regression_table fits our hypothesis test to the data and gives us a table of values. The probability of observing a test statistic at least as extreme as the one observed from our sample, assuming the null hypothesis is true, is 0. Our alpha level is 0.05, and our p-value is 0, and because p-value \< alpha value, we can reject the null hypothesis and conclude that there is a statistical significance between the average budget and a movie passing or failing the bechdel test.\ 

One can see in @fig-Categorical_vizualization the Catagorical Visualization of difference between average movie budgets.\

### Regression Equation:\

$$
\widehat{Budget} = b_0 + b_1 \cdot 1_{Pass}(Binary)
$$


$$
\widehat{Budget} = 62911555 + (-16637388 * 1_{Pass}(Binary))
$$









